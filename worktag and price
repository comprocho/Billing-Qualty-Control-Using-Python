#For Loop in a directory to go through Excel Files and extract worktag information and prices.

import pandas as pd
import numpy as np 
import glob as glob

file_name = []
prices = []
idx = []
count = 0

for f in glob.glob("*.xlsx"):
    df = pd.read_excel(f,skiprows = 3)
    total_price = df['Total'].loc[40]
    count += 1
    file_name.append(f)
    prices.append(total_price)
    idx.append(count)
#     print (count, '\t', f,'\t', '$', total_price)
    
worktags = pd.DataFrame({'Worktag': file_name,
                         'Price': prices,
                         'Index': idx})
worktags = worktags[['Index','Worktag', 'Price']].set_index('Index')
worktags['Worktag'] = worktags['Worktag'].str.replace('(.xlsx)', '')

worktags

invoices = pd.read_excel('Invoice Details.xls', skiprows=8)
# for g in glob.glob("*.xls"):
invoices = invoices[['Worktags', 'Fee']]


replacements = {'Worktags' : {
                    r'(GMS Center-|Fund-|Program-|Purpose Code-|Assignee-|Grant-|Gift-|Project-|Lab Support|-|\(|\))': '',
                    r'(,)': ' '
                }
            }
invoices.replace(replacements, regex= True, inplace=True)                  
invoices
